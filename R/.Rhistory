for(j in 1:length(x.val)){if(x.val2[i]==x.val[j]){ac2[i]<-ac[j]}}
}
lines(x.val2,ac2,col="red")
# Nabyva-li ciselna diskretni promenna mnoha hodnot, je mozne ji zobrazit
#   pomoci histogramu
# napriklad velikost motoru je jiste ciselna diskretni promenna
mot <- Cars93$EngineSize
hist(mot,col="skyblue",border="darkblue",main="Histogram",
xlab="Velikost motoru",ylab="Absolutni cetnosti")
length(mot)
load("C:/Users/petri/Desktop/Vysoká_skola/PAS/R/Kojeni.RData")
load("Kojeni.RData")
table(porodnice)
#   Nominální (Slova bez pořadí)
porodnice <- Kojeni$Porodnice
table(porodnice)
# absolutní četnost
(ac <- table(porodnice))
# relativní četnost
prop.table(ac)
# relativní četnost
prop.table(ac) * 100
# relativní četnost
round(prop.table(ac) * 100, 2)
# relativní četnost
(rc <- round(prop.table(ac) * 100, 2))
cbind(ac = "Absolutní četnost", rc = "Relativní četnost")
cbind("Absolutní četnost" = ac, "Relativní četnost" = rc)
t <- prop.table(table(Por.poh)) * 100
t
barplot(table(Por.poh),col=2:5,main="Sloupcovy graf")
ba
barplot(table(Por.poh),main="Sloupcovy graf")
barplot(table(Por.poh),col=2:5,main="Sloupcovy graf")
#KOLAČOVY GRAF
pie(table(Por.poh),col=2:5,main="Kolacovy graf")
#Popisky
leg<-sort(unique(Por.poh))
rc<-round(prop.table(table(Por.poh))*100,2)
for(i in 1:length(leg)){
leg[i]<-paste(leg[i],"(",rc[i],"%)")
}
pie(table(Por.poh),col=2:5,main="Kolacovy graf",labels=leg)
table(Vzdelani)
Vzdelani <- Kojeni$Vzdelani
table(Vzdelani)
ordered(Vzdelani, levels = c("základní", "maturita", "VŠ") )
Vzdelani <- ordered(Vzdelani, levels = c("základní", "maturita", "VŠ") )
table(Vzdelani)
# absolutni cetnosti
(ac<-table(Vzdel))
# relativni cetnosti
(rc<-round(prop.table(table(Vzdel)),2))
cbind("absolutni"=ac,"relativni"=rc)
#  kumulativni absolutni cetnosti
(kac<-cumsum(ac))
#  kumulativni absolutni cetnosti
(kac<-cumsum(ac))
# kumulativni relativni cetnosti
(krc<-cumsum(rc))
cbind("n(i)"=ac,"N(i)"=kac,"p(i)"=rc,"P(i)"=krc)
barplot(ac, col = 2:3, main = "Sloupcový graf")
barplot(ac, col = 2:4, main = "Sloupcový graf")
load("Cars.RData")
(ac <- table(valce))
hist(valce2, )
hist(valce2)
#valce bez rotary
valce2 <- droplevels(valce[valce != "rotary"])
hist(valce2)
hist(valce2, plot = F)
(ac<-table(valce2))
(kac<-cumsum(ac))
(rc<-round(prop.table(table(valce2)),2))
(krc<-cumsum(rc))
data.frame(cbind("n(i)"=ac,"N(i)"=kac,"f(i)"=rc,"F(i)"=krc))
library(ggplot2)
# Frekvencni polygon
x.val<-as.numeric(as.character(names(ac)))
names(ac)
ac.n<-as.numeric(ac)
# zmena typu promenne kvuli popiskum na y-ove ose v grafu
plot(x.val,ac.n,type="h",lwd=3,col="darkgreen",main="Frekvencni polygon",
xlab="Pocet valcu",ylab="Absolutni cetnosti")
x.val2<-min(x.val):max(x.val)
x.val2
ac2<-rep(0,length(x.val2))
ac2
for(i in 1:length(x.val2)){
for(j in 1:length(x.val)){
if(x.val2[i]==x.val[j]){ac2[i]<-ac[j]}}
}
lines(x.val2,ac2,col="red")
length(valce2)
hist(valce2)
hist(valce)
e_size <- cars$EngineSize
e_size <- cars$EngineSize
hist(e_size)
valce <- cars$Cylinders
hist(valce)
# Nabyva-li ciselna diskretni promenna mnoha hodnot, je mozne ji zobrazit
#   pomoci histogramu
# napriklad velikost motoru je jiste ciselna diskretni promenna
mot <- Cars93$EngineSize
hist(mot,col="skyblue",border="darkblue",main="Histogram",
xlab="Velikost motoru",ylab="Absolutni cetnosti")
## Frekvencni rozdeleni pro ciselne promenne
# spoctete frekvencni rozdeleni pro silu vozu (Horse power)
hp <- Cars93$Horsepower
hist(hp,col="skyblue",border="darkblue",main="Histogram",
xlab="Sila vozu",ylab="Absolutni cetnosti")
hist(hp,col="skyblue",border="darkblue",main="Histogram",
xlab="Sila vozu",ylab="Absolutni cetnosti",breaks=10)
# pomoci parametru "breaks" je mozne nastavit i jemnejsi deleni,
#   ale pro tabulku frekvencniho rozdeleni asi neni treba
hist(hp,plot=F)
deleni<-hist(hp,plot=F)$breaks
popis<-as.character(deleni[-1])
for(i in 1:length(popis)){
popis[i]<-paste("(",deleni[i],",",deleni[i+1],"]")
}
ac<-hist(hp,plot=F)$counts
kac<-cumsum(ac)
rc<-round(ac/sum(ac),3)
krc<-cumsum(rc)
names(ac) <- popis
data.frame("n(i)"=ac,"N(i)"=kac,"f(i)"=rc,"F(i)"=krc)
popis
hp <- Cars93$Horsepower
hist(hp,col="skyblue",border="darkblue",main="Histogram",
xlab="Sila vozu",ylab="Absolutni cetnosti")
hist(hp,col="skyblue",border="darkblue",main="Histogram",
xlab="Sila vozu",ylab="Absolutni cetnosti",breaks=10)
# pomoci parametru "breaks" je mozne nastavit i jemnejsi deleni,
#   ale pro tabulku frekvencniho rozdeleni asi neni treba
hist(hp,plot=F)
deleni<-hist(hp,plot=F)$breaks
popis<-as.character(deleni[-1])
for(i in 1:length(popis)){
popis[i]<-paste("(",deleni[i],",",deleni[i+1],"]")
}
ac<-hist(hp,plot=F)$counts
kac<-cumsum(ac)
rc<-round(ac/sum(ac),3)
krc<-cumsum(rc)
names(ac) <- popis
data.frame("n(i)"=ac,"N(i)"=kac,"f(i)"=rc,"F(i)"=krc)
############################
# Krabicovy graf
boxplot(hp,col="yellow",border="orange3",main="Krabicovy graf",
ylab="Sila vozu")
# samostatne body ukazuji odlehla pozorovani
boxplot(hp,col="yellow",border="orange3",main="Krabicovy graf",
ylab="Sila vozu",range = 3)
## Popisne statistiky polohy pro ciselnou promennou
# Co je v grafu videt
min(hp)
max(hp)
# extremy
quantile(hp,0.25)
quantile(hp,0.75)
# median
fivenum(hp)
mean(hp)
# prumer
summary(hp)
summary(hp)
# Krabicovy graf
boxplot(hp,col="yellow",border="orange3",main="Krabicovy graf",
ylab="Sila vozu")
ac<-table(pasengers)
kac<-cumsum(ac)
rc<-round(prop.table(table(pasengers)),2)
krc<-cumsum(rc)
data.frame(cbind("n(i)"=ac,"N(i)"=kac,"f(i)"=rc,"F(i)"=krc))
x.val<-as.numeric(as.character(names(ac)))
ac.n<-as.numeric(ac)
plot(x.val,ac.n,type="h",lwd=3,col="darkgreen",main="Frekvencni polygon",
xlab="Počet pasažérů",ylab="Absolutni cetnosti")
pasengers <- Cars93$Passengers
ac<-table(pasengers)
kac<-cumsum(ac)
rc<-round(prop.table(table(pasengers)),2)
krc<-cumsum(rc)
data.frame(cbind("n(i)"=ac,"N(i)"=kac,"f(i)"=rc,"F(i)"=krc))
x.val<-as.numeric(as.character(names(ac)))
ac.n<-as.numeric(ac)
plot(x.val,ac.n,type="h",lwd=3,col="darkgreen",main="Frekvencni polygon",
xlab="Počet pasažérů",ylab="Absolutni cetnosti")
x.val2<-min(x.val):max(x.val)
ac2<-rep(0,length(x.val2))
for(i in 1:length(x.val2)){
for(j in 1:length(x.val)){if(x.val2[i]==x.val[j]){ac2[i]<-ac[j]}}
}
lines(x.val2,ac2,col="red")
delka_Vozu <- Cars93$Length
summary(delka_Vozu)
hist(delka_Vozu, plot = F)
hist(delka_Vozu)
tapply(Cars93$Length, Cars93$Origin, summary)
boxplot(Cars93$Length ~ Cars93$Origin)
# Jaka je variabilita delky vozu
delka <- Cars93$Length
var(delka)
sd(delka)
# Zakladni charakteristiky variability odvozene od prumeru
# Vyberovy rozptyl a smerodatna odchylka
# Jake maji jednotky, jak je interpretovat?
IQR(delka)
MAD(delka)
#############################
## Popisne statistiky variability
library(DescTools)
MAD(delka)
# Robustni charakteristiky variability mene citlive na odlehla pozorovani
# Mezikvartilove rozpeti a medianova absolutni odchylka okolo medianu
# Jake maji jednotky, jak je interpretovat?
CoefVar(delka)
# Standardizovane veliciny - z.skory
z.val<-scale(delka)
# Caharakteristiky tvaru rozdeleni
Skew(delka)
Kurt(delka)
# Caharakteristiky tvaru rozdeleni
hist(delka)
boxplot(delka)
# Standardizovane veliciny - z.skory
z.val<-scale(delka)
z.val
# Caharakteristiky tvaru rozdeleni
hist(delka)
col
colors
colors()
## Frekvencni rozdeleni pro ciselne promenne
# spoctete frekvencni rozdeleni pro silu vozu (Horse power)
hp <- Cars93$Horsepower
hist(hp,col="skyblue",border="darkblue",main="Histogram",
xlab="Sila vozu",ylab="Absolutni cetnosti")
hist(density(hp),col="skyblue",border="darkblue",main="Histogram",
xlab="Sila vozu",ylab="Absolutni cetnosti")
# Caharakteristiky tvaru rozdeleni
hist(delka, col = "tomato", main = "Histogram", ylab = "Absolutní četnosti", xlab = "Síla vozu")
hist(delka, col = "tomato", main = "Histogram", ylab = "Husota", xlab = "Síla vozu", freq = False)
hist(delka, col = "tomato", main = "Histogram", ylab = "Husota", xlab = "Síla vozu", freq = FALSE)
#hist(delka, col = "tomato", main = "Histogram", ylab = "Husota", xlab = "Síla vozu", freq = FALSE)
boxplot(delka)
mean(delka)
median(delka)
# Vyzkousejte pro promennou rm a nox
rm <-Boston$rm
boxplot(rm, col = "green", border = "black")
boxplot(rm, col = "green", border = "black", range = 3)
mean(rm)
median(rm)
nox <- Boston$nox
hist(nox, col = "violet", border = "white", xlab = "nox", main = "Histogram")
boxplot(nox, col = "salmon", border = "black")
mean(nox)
median(nox)
# Ohodnotte normalitu promenne rm
# vyska
rm <- Stulong$rm
# histogram - hodi se ho kreslit v "hustote"
hist(rm,col="skyblue",border="darkblue",main="Histogram",ylab="Hustota",
xlab="rm", freq=F)
# Ohodnotte normalitu promenne rm
# vyska
rm <- Stulong$rm
# histogram - hodi se ho kreslit v "hustote"
hist(rm,col="skyblue",border="darkblue",main="Histogram",ylab="Hustota",
xlab="rm", freq=F)
# Sikmost, spicatost
Skew(rm)
# Ohodnotte normalitu promenne rm
# vyska
rm <- Stulong$rm
rm
# Pomoci funkce
MeanCI(reakce,method="boot")
# Potrebne knihovny
library(fitdistrplus)
library(DescTools)
load("Stulong.RData")
# Nactete databazi Stulong.RData
names(Stulong)<-c("ID","vyska","vaha","syst1","syst2","chlst","vino","cukr","bmi",
"vek","KOURrisk","Skupina","VekK")
## Jake rozdeleni ma cholesterol?
chol <- Stulong$chlst
hist(chol,col="azure", border="darkblue", main="Histogram pro hladinu cholesterolu", xlab="Cholesterol")
PlotQQ(chol, pch=19)
Skew(chol)
Kurt(chol)
hist(chol,col="azure", border="darkblue", main="Histogram pro hladinu cholesterolu", xlab="Cholesterol")
PlotQQ(chol, pch=19)
# Pomer sikmosti a spicatosti, k jakemu rozdeleni mam nejblize
descdist(chol ,discrete=FALSE, boot=1000)
# zkusim normalni, logisticke a lognormalni
(fit1 <- fitdist(chol,"norm"))
(fit2 <- fitdist(chol,"logis"))
(fit3 <- fitdist(chol,"lnorm"))
# porovnani pomoci AIC a BIC kriterii
data.frame(distr=c("Norm","Logis","Lognorm"),
AIC=c(fit1$aic,fit2$aic,fit3$aic),
BIC=c(fit1$bic,fit2$bic,fit3$bic)
)
# 95%-ni intervaly spolehlivosti pro odhady parametru lognormalniho rozdeleni
data.frame(estimate=coef(fit3),
ci0.95lo=coef(fit3)-1.96*fit3$sd,
ci0.95up=coef(fit3)+1.96*fit3$sd
)
# kontrola, jak jednotlivym rozdelenim sedi Q-Q plot
PlotQQ(chol)
PlotQQ(chol, qdist=function(p) qlogis(p,location=coef(fit2)[1],scale=coef(fit2)[2]))
PlotQQ(chol, qdist=function(p) qlnorm(p,meanlog=coef(fit3)[1],sdlog=coef(fit3)[2]))
sys <- Stulong$syst1
hist(sys)
Skew(sys)
Kurt(sys)
descdist(sys ,discrete=FALSE, boot=1000)
(fit1 <- fitdist(sys, "norm"))
(fit2 <- fitdist(sys, "gamma"))
(fit3 <- fitdist(sys, "lnorm"))
data.frame(distr=c("Norm","Logis","Lognorm"),
AIC=c(fit1$aic,fit2$aic,fit3$aic),
BIC=c(fit1$bic,fit2$bic,fit3$bic)
)
PlotQQ(sys)
PlotQQ(sys, qdist=function(p) qlogis(p,location=coef(fit2)[1],scale=coef(fit2)[2]))
PlotQQ(sys, qdist=function(p) qlnorm(p,meanlog=coef(fit3)[1],sdlog=coef(fit3)[2]))
## Jakym rozdelenim se ridi cukr?
cukr <-Stulong$cukr
hist(cukr)
Skew(cukr)
Kurt(cukr)
PlotQQ(cukr)
descdist(cukr, discrete = FALSE, boot = 1000)
(fit1 <- fitdist(cukr, "exp"))
(fit2 <- fitdist(cukr, "gamma"))
(fit3 <- fitdist(cukr, "lnorm"))
PlotQQ(cukr, qdist=function(p) qexp(p,location=coef(fit1)[1],scale=coef(fit1)[2]))
(fit2 <- fitdist(cukr, "gamma"))
(fit3 <- fitdist(cukr, "lnorm"))
(fit1 <- fitdist(cukr, "exp"))
(fit2 <- fitdist(cukr, "gamma"))
(fit3 <- fitdist(cukr, "lnorm"))
n <- n(Price)
n <- length(Price)
# Kvantitativní (Numerické)
Price <- cars$Price
n <- length(Price)
n
# Kvantitativní (Numerické)
library(DescTools)
SD <- sd(Price)
SD
n <- length(Price)
Mean <- mean(Price)
sumary <- summary(Price)
SD <- sd(Price)
IQR <- IQR(Price)
MAD <- MAD(Price)
CoefVar <- CoefVar(Price)
Skew <- Skew(Price)
Kurt <- Kurt(Price)
data.frame("n" = n, "Mean" = Mean, "" = sumary)
data.frame("n" = n, "Mean" = Mean, "summary" = sumary)
data.frame("n" = n, "Mean" = Mean)
## popisne statistiky pro ordinalni promennou
# popiste, jake mely vozy Airbagy
ab <- Cars93$AirBags
unique
(ac <- table(ab))
(kac<-cumsum(ac))
(rc<-round(prop.table(table(ab)),2))
(krc<-cumsum(rc))
data.frame(cbind("n(i)"=ac,"N(i)"=kac,"f(i)"=rc,"F(i)"=krc))
data.frame(cbind("n" = n, "Mean" = Mean, sumary) )
data.frame(cbind("n" = n, "Mean" = Mean, "sumary" = sumary) )
data.frame(cbind("n" = n, "Mean" = Mean, "sumary" = cbind(sumary)) )
data.frame(cbind("n" = n, "Mean" = Mean))
data.frame("" = Price cbind("n" = n, "Mean" = Mean))
data.frame("" = "Price" cbind("n" = n, "Mean" = Mean))
data.frame("" = "Price" ,cbind("n" = n, "Mean" = Mean))
data.frame(" " = "Price" ,cbind("n" = n, "Mean" = Mean))
data.frame("\t" = "Price" ,cbind("n" = n, "Mean" = Mean))
data.frame("promm" = "Price" ,cbind("n" = n, "Mean" = Mean))
sumary[1]
data.frame("promm" = "Price" ,cbind("n" = n, "Mean" = Mean, sumary[1]))
data.frame("promm" = "Price" ,cbind("n" = n, "Mean" = Mean, sumary[3]))
data.frame("promm" = "Price" ,cbind("n" = n, "Mean" = Mean), sumary[3] )
data.frame("promm" = "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], "1st Qu" = sumary[2], "Median" = sumary[3], "3rd Qu" = sumary[4], "Max" = sumary[5]))
data.frame("promm" = "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], "1st Qu" = sumary[2], "Median" = sumary[3], "3rdQu" = sumary[4], "Max" = sumary[5]))
sumary <- summary(Price)
sumary
data.frame(do.call(rbind, sumary)
data.frame(do.call(rbind, sumary))
data.frame("promm" = "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], "First Qu" = sumary[2], "Median" = sumary[3], "3rdQu" = sumary[4], "Max" = sumary[5]))
data.frame("promm" = "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], "First Qu" = sumary[2], "Median" = sumary[3], "ThirdQu" = sumary[4], "Max" = sumary[5]))
data.frame("promm" = "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], "First Qu" = sumary[2], "Median" = sumary[3], "Third Qu" = sumary[4], "Max" = sumary[5]))
data.frame(promm = "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], "First Qu" = sumary[2], "Median" = sumary[3], "Third Qu" = sumary[4], "Max" = sumary[5]))
data.frame( "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], "First Qu" = sumary[2], "Median" = sumary[3], "Third Qu" = sumary[4], "Max" = sumary[5]))
data.frame( prom = "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], "First Qu" = sumary[2], "Median" = sumary[3], "Third Qu" = sumary[4], "Max" = sumary[5]))
data.frame( prom = "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], 1stQU = sumary[2], "Median" = sumary[3], "Third Qu" = sumary[4], "Max" = sumary[5]))
data.frame( prom = "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], 1st.Qu = sumary[2], "Median" = sumary[3], "Third Qu" = sumary[4], "Max" = sumary[5]))
data.frame( prom = "Price" ,cbind("n" = n, "Mean" = Mean, "Min" = sumary[1], "First Qu" = sumary[2], "Median" = sumary[3], "Third Qu" = sumary[4], "Max" = sumary[5]))
data.frame( prom = "Price" ,"n" = n, "Mean" = Mean, "Min" = sumary[1], "First Qu" = sumary[2], "Median" = sumary[3], "Third Qu" = sumary[4], "Max" = sumary[5])
data.frame( prom = "Price" ,"n" = n, "Mean" = Mean, "Min" = sumary[1], "First Qu" = sumary[2], "Median" = sumary[3], "Third Qu" = sumary[4], "Max" = sumary[5])
data.frame( prom = "Price" ,cbind("n" = n,
"Mean" = Mean,
"Min" = sumary[1],
"First Qu" = sumary[2],
"Median" = sumary[3],
"Third Qu" = sumary[4],
"Max" = sumary[5]),
"SD" = SD,
"IQR" = IQR,
"MAD" = MAD,
"CoefVar" = CoefVar,
"Skew" = Skew,
"Kurt" = Kurt
)
Huber <- huber(Price)
Huber
hubers(Price)
HuberM(Price)
Huber <- HuberM(Price)
data.frame( prom = "Price" ,cbind("n" = n,
"Mean" = Mean,
"Huber" = Huber,
"Min" = sumary[1],
"First Qu" = sumary[2],
"Median" = sumary[3],
"Third Qu" = sumary[4],
"Max" = sumary[5]),
"SD" = SD,
"IQR" = IQR,
"MAD" = MAD,
"CoefVar" = CoefVar,
"Skew" = Skew,
"Kurt" = Kurt
)
Price <- cars$Price
prom <- Price
n <- length(prom)
Mean <- mean(prom)
Huber <- HuberM(prom)
sumary <- summary(prom)
SD <- sd(prom)
IQR <- IQR(prom)
MAD <- MAD(prom)
CoefVar <- CoefVar(prom)
Skew <- Skew(prom)
Kurt <- Kurt(prom)
data.frame(do.call(rbind, sumary))
Price <- cars$Price
prom <- Price
n <- length(prom)
Mean <- mean(prom)
Huber <- HuberM(prom)
sumary <- summary(prom)
SD <- sd(prom)
IQR <- IQR(prom)
MAD <- MAD(prom)
CoefVar <- CoefVar(prom)
Skew <- Skew(prom)
Kurt <- Kurt(prom)
data.frame(do.call(rbind, sumary))
Price <- cars$Price
prom <- Price
n <- length(prom)
Mean <- mean(prom)
Huber <- HuberM(prom)
sumary <- summary(prom)
SD <- sd(prom)
IQR <- IQR(prom)
MAD <- MAD(prom)
CoefVar <- CoefVar(prom)
Skew <- Skew(prom)
Kurt <- Kurt(prom)
data.frame(do.call(rbind, sumary))
data.frame(prom = prom ,cbind("n" = n,
"Mean" = Mean,
"Huber" = Huber,
"Min" = sumary[1],
"First Qu" = sumary[2],
"Median" = sumary[3],
"Third Qu" = sumary[4],
"Max" = sumary[5]),
"SD" = SD,
"IQR" = IQR,
"MAD" = MAD,
"CoefVar" = CoefVar,
"Skew" = Skew,
"Kurt" = Kurt
)
data.frame(prom = "Price" ,cbind("n" = n,
"Mean" = Mean,
"Huber" = Huber,
"Min" = sumary[1],
"First Qu" = sumary[2],
"Median" = sumary[3],
"Third Qu" = sumary[4],
"Max" = sumary[5]),
"SD" = SD,
"IQR" = IQR,
"MAD" = MAD,
"CoefVar" = CoefVar,
"Skew" = Skew,
"Kurt" = Kurt
)
